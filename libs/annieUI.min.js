var __extends=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function i(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),annieUI;!function(e){var t=annie.Sprite,a=annie.Shape,i=function(e){function i(i,n,o,r){void 0===r&&(r=!0);var s=e.call(this)||this;s.isVertical=!0,s.viewWidth=0,s.viewHeight=0,s._tweenId=0,s.maxDistance=1040,s.distance=0,s.minDis=2,s.maskObj=new a,s.view=new t,s.lastValue=0,s.speed=0,s.addSpeed=0,s.isStop=!0,s.maxSpeed=100,s.fSpeed=20,s.paramXY="y",s.stopTimes=-1,s.isMouseDownState=0,s.autoScroll=!1,s.isSpringBack=!0,s.isCanUseMouseScroll=!0;var l=s;l._instanceType="annieUI.ScrollPage",l.addChild(l.maskObj),l.addChild(l.view),l.view.mask=l.maskObj,l.maskObj._isUseToMask=0,l.maskObj.alpha=0,l.maxDistance=o,l.setViewRect(i,n,r);var d=l.onMouseEvent.bind(l);return l.addEventListener(annie.MouseEvent.MOUSE_DOWN,d,!1),l.addEventListener(annie.MouseEvent.MOUSE_MOVE,d,!1),l.addEventListener(annie.MouseEvent.MOUSE_UP,d,!1),l.addEventListener(annie.MouseEvent.MOUSE_OUT,d),l._timer=new annie.Timer(20),l._timer.addEventListener(annie.Event.TIMER,function(){var e=l.view;if(void 0!=e&&e._isOnStage){if(l.autoScroll)return;if(!l.isSpringBack){if(e[l.paramXY]>0)return l.addSpeed=0,l.speed=0,l.isStop=!0,void(e[l.paramXY]=0);if(e[l.paramXY]<l.distance-l.maxDistance)return l.addSpeed=0,l.speed=0,l.isStop=!0,void(e[l.paramXY]=l.distance-l.maxDistance)}if(l.isStop)l.stopTimes>=0&&++l.stopTimes>=15&&(l.speed=0,(e[l.paramXY]>0||e[l.paramXY]<l.distance-l.maxDistance)&&(l.isStop=!1,l.stopTimes=-1));else if(Math.abs(l.speed)>0)e[l.paramXY]+=l.speed,e[l.paramXY]>0||e[l.paramXY]<l.distance-l.maxDistance?l.speed+=l.addSpeed*l.fSpeed:l.speed+=l.addSpeed,l.speed*l.addSpeed>0&&(l.dispatchEvent("onScrollStop"),l.speed=0);else if(0!=l.addSpeed){if(e[l.paramXY]>0||e[l.paramXY]<l.distance-l.maxDistance){var t=0;l.addSpeed>0&&l.distance<l.maxDistance&&(t=l.distance-l.maxDistance),e[l.paramXY]+=.4*(t-e[l.paramXY]),Math.abs(t-e[l.paramXY])<.1&&(l.isStop=!0,l.addSpeed>0?l.dispatchEvent("onScrollToEnd"):l.dispatchEvent("onScrollToHead"))}}else l.isStop=!0}}),l._timer.start(),s}return __extends(i,e),i.prototype.setViewRect=function(e,t,a){var i=this;i.maskObj.clear(),i.maskObj.beginFill("#000000"),i.maskObj.drawRect(0,0,e,t),i.viewWidth=e,i.viewHeight=t,i.maskObj.endFill(),void 0!=a&&(i.isVertical=a),i.isVertical?(i.distance=i.viewHeight,i.paramXY="y"):(i.distance=i.viewWidth,i.paramXY="x")},i.prototype.onMouseEvent=function(e){var t=this;if(t.isCanUseMouseScroll){var a=t.view;if(e.type==annie.MouseEvent.MOUSE_DOWN)t.isStop||(t.isStop=!0),t.autoScroll&&(t.autoScroll=!1,annie.Tween.kill(t._tweenId)),t.isVertical?t.lastValue=e.localY:t.lastValue=e.localX,t.speed=0,t.isMouseDownState=1,t.dispatchEvent("onScrollStart");else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(t.isMouseDownState<1)return;t.isMouseDownState=2;var i=void 0;if(i=t.isVertical?e.localY:e.localX,t.speed=i-t.lastValue,t.speed>t.minDis?(t.addSpeed=-2,t.speed>t.maxSpeed&&(t.speed=t.maxSpeed)):t.speed<-t.minDis?(t.speed<-t.maxSpeed&&(t.speed=-t.maxSpeed),t.addSpeed=2):t.speed=0,0!=t.speed){var n=1;(a[t.paramXY]>0||a[t.paramXY]<t.distance-t.maxDistance)&&(n=.2),a[t.paramXY]+=(i-t.lastValue)*n}t.lastValue=i,t.stopTimes=0}else t.isStop=!1,t.stopTimes=-1,0==t.speed&&2==t.isMouseDownState&&t.dispatchEvent("onScrollStop"),t.isMouseDownState=0}},i.prototype.scrollTo=function(e,t){void 0===t&&(t=0);var a=this,i="x"==a.paramXY?a.viewWidth:a.viewHeight;if(e<0?e=0:e>a.maxDistance-i&&(e=a.maxDistance-i),t>0){if(Math.abs(a.view[a.paramXY]+e)>2){-1!=a._tweenId&&annie.Tween.kill(a._tweenId),a.autoScroll=!0,a.isStop=!0,a.isMouseDownState=0;var n={};n.onComplete=function(){a.autoScroll=!1,a.dispatchEvent("onScrollStop"),0==e?a.dispatchEvent("onScrollToHead"):e==a.maxDistance-i&&a.dispatchEvent("onScrollToEnd")},n[a.paramXY]=-e,a._tweenId=annie.Tween.to(a.view,t,n),0==a.speed&&a.dispatchEvent("onScrollStart")}}else a.view[a.paramXY]=-e},i.prototype.destroy=function(){var t=this;t.maskObj=null,t.view=null,e.prototype.destroy.call(this)},Object.defineProperty(i.prototype,"currentPos",{get:function(){var e=this;return-e.view[e.paramXY]},enumerable:!0,configurable:!0}),i}(t);e.ScrollPage=i}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.isVertical=!0,t.speed=.2,t.maxSpeed=15,t.fSpeed=.1,t._isMouseDownState=0,t._moveDis=0,t.isCanScroll=!0,t._isStop=!1,t._stage=null,t._maxDis=1,t._lastValue=0,t._frame=1,t.mouseEvent=null,t._instanceType="annieUI.Scroller",t}return __extends(t,e),t.prototype.init=function(e,t,a){void 0===a&&(a=!0);var i=this;i.mouseEvent=i.onMouseEvent.bind(i),i._stage=e,i._maxDis=t,e.addEventListener(annie.MouseEvent.MOUSE_DOWN,i.mouseEvent,!1),e.addEventListener(annie.MouseEvent.MOUSE_MOVE,i.mouseEvent,!1),e.addEventListener(annie.MouseEvent.MOUSE_UP,i.mouseEvent,!1),e.addEventListener(annie.MouseEvent.MOUSE_OUT,i.mouseEvent),i._timer=new annie.Timer(20),i._timer.addEventListener(annie.Event.TIMER,function(){if(i._isStop){var e=i._frame;Math.abs(e-i._moveDis)>.001?(e+=i.fSpeed*(i._moveDis-e),e<1?(e=1,i._isStop=!0):e>i._maxDis&&(e=i._maxDis,i._isStop=!0),i.dispatchEvent("onScrollIng",e),i._frame=e):i._isStop=!1}}),i._timer.start()},t.prototype.onMouseEvent=function(e){var t=this;if(t.isCanScroll){var a=t._frame,i=t._moveDis;if(e.type==annie.MouseEvent.MOUSE_DOWN)t.isVertical?t._lastValue=e.localY:t._lastValue=e.localX,i=0,t._isMouseDownState=1,t._isStop=!1;else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(t._isMouseDownState<1)return;t._isMouseDownState=2;var n=void 0;n=t.isVertical?e.localY:e.localX,i=t._lastValue-n,i>t.maxSpeed?i=t.maxSpeed:i<-t.maxSpeed&&(i=-t.maxSpeed),0!=i&&(a+=i*t.speed,a<1?a=1:a>t._maxDis&&(a=t._maxDis),t._frame=a,t.dispatchEvent("onScrollIng",t._frame)),t._lastValue=n}else i*=6,i+=t._frame,i<1?i=1:i>t._maxDis&&(i=t._maxDis),t._isMouseDownState=0,t._isStop=!0;t._moveDis=i}},t.prototype.destroy=function(){var t=this;t._stage.removeEventListener(annie.MouseEvent.MOUSE_MOVE,t.mouseEvent,!1),t._stage.removeEventListener(annie.MouseEvent.MOUSE_UP,t.mouseEvent,!1),t._stage.removeEventListener(annie.MouseEvent.MOUSE_DOWN,t.mouseEvent,!1),t._stage.removeEventListener(annie.MouseEvent.MOUSE_OUT,t.mouseEvent),t._timer.stop(),t._timer.destroy(),t._timer=null,e.prototype.destroy.call(this)},t}(annie.EventDispatcher);e.Scroller=t}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,a=function(e){function t(){var t=e.call(this)||this;t.maskType=0;var a=t;return a._instanceType="annieUI.FacePhoto",a.photo=new Image,a.maskObj=new annie.Shape,a.photo.onload=function(e){a.bitmap=new annie.Bitmap(a.photo),a.maskObj.clear(),a.maskObj.beginFill("#000000");var t=a.radio/(a.photo.width<a.photo.height?a.photo.width:a.photo.height);a.bitmap.scaleX=a.bitmap.scaleY=t,a.bitmap.x=a.radioW-a.photo.width*t>>1,a.bitmap.y=a.radioH-a.photo.height*t>>1,0==a.maskType?a.maskObj.drawEllipse(0,0,a.radioW,a.radioH):a.maskObj.drawRect(0,0,a.radioW,a.radioH),a.maskObj.endFill(),a.addChild(a.bitmap),a.addChild(a.maskObj),a.bitmap.mask=a.maskObj,a.dispatchEvent("onComplete")},t}return __extends(t,e),t.prototype.init=function(e,t,a,i){void 0===i&&(i=0);var n=this;n._bounds.width=t,n._bounds.height=a,n.radioW=t,n.radioH=a,n.radio=t>a?t:a,n.photo.corssOrigin="anonymous",n.photo.src!=e&&(n.photo.src=e),n.maskType!=i&&(n.maskType=i)},t.prototype.destroy=function(){var t=this;t.bitmap=null,t.photo=null,t.maskObj=null,e.prototype.destroy.call(this)},t}(t);e.FacePhoto=a}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,a=function(e){function t(t,a,i,n){void 0===i&&(i=!0),void 0===n&&(n=null);var o=e.call(this)||this;o.listLen=0,o.view=new annie.Sprite,o.maskObj=new annie.Shape,o.slideSpeed=.2,o._isBreak=!1,o.distance=0,o.touchEndX=0,o.movingX=0,o.movingY=0,o._moveDis=0,o.touchEndY=0,o.currentPageIndex=0,o.reBound=.3,o.isPageFollowToMove=!1,o.follow=.7,o.isMoving=!1,o.viewWidth=0,o.viewHeight=0,o.pageList=[],o.pageClassList=[],o.lastX=0,o.lastY=0,o.isMouseDown=!1,o.isCanUseMouseScroll=!0,o.canSlideNext=!0,o.canSlidePrev=!0,o.paramXY="y";var r=o;r.isVertical=i,r._ease=n,i?(r.paramXY="y",r.distance=a):(r.paramXY="x",r.distance=t),r.addChild(r.maskObj),r.addChild(r.view),r.view.mask=r.maskObj,r.maskObj._isUseToMask=0,r.maskObj.alpha=0,r.setMask(t,a);var s=r.onMouseEvent.bind(r);return r.addEventListener(annie.MouseEvent.MOUSE_DOWN,s,!1),r.addEventListener(annie.MouseEvent.MOUSE_MOVE,s,!1),r.addEventListener(annie.MouseEvent.MOUSE_UP,s,!1),r.addEventListener(annie.MouseEvent.MOUSE_OUT,s),o}return __extends(t,e),t.prototype.setMask=function(e,t){var a=this;a.maskObj.clear(),a.maskObj.beginFill("#000000"),a.maskObj.drawRect(0,0,e,t),a.viewWidth=e,a.viewHeight=t,a.maskObj.endFill()},t.prototype.onMouseEvent=function(e){var t=this;if(!t.isMoving&&t.isCanUseMouseScroll)if(e.type==annie.MouseEvent.MOUSE_DOWN)t.touchEndX=e.localX,t.touchEndY=e.localY,t.movingX=t.movingY=0,t.isMouseDown=!0,t._isBreak=!1,t.lastX=e.localX,t.lastY=e.localY,t._moveDis=0;else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(!t.isMouseDown)return;var a=e.localX-t.touchEndX,i=e.localY-t.touchEndY,n=i,o=a,r=t.movingY;if(t._moveDis=t.lastY-e.localY,t.movingX=a,t.movingY=i,t.isVertical||(n=a,o=i,r=t.movingX,t._moveDis=t.lastX-e.localX),Math.abs(n)>Math.abs(o)){if(t.isPageFollowToMove||Math.abs(n)-Math.abs(r)<-1&&(t._isBreak=!0),n>0){if(0==t.currentPageIndex)t.view[t.paramXY]-=t._moveDis*t.reBound;else if(t.isPageFollowToMove){t.view[t.paramXY]-=t._moveDis*t.follow;var s=t.currentPageIndex-1;t.pageList[s]||(t.pageList[s]=new t.pageClassList[s]),t.pageList[s].parent!=t.view&&(t.view.addChild(t.pageList[s]),t.pageList[s][t.paramXY]=s*t.distance)}}else if(n<0)if(t.currentPageIndex==t.listLen-1)t.view[t.paramXY]-=t._moveDis*t.reBound;else if(t.isPageFollowToMove){t.view[t.paramXY]-=t._moveDis*t.follow;var s=t.currentPageIndex+1;t.pageList[s]||(t.pageList[s]=new t.pageClassList[s]),t.pageList[s].parent!=t.view&&(t.view.addChild(t.pageList[s]),t.pageList[s][t.paramXY]=s*t.distance)}}else t.movingX=t.movingY=0;t.lastX=e.localX,t.lastY=e.localY}else{if(!t.isMouseDown)return;var n=t.movingY;if(t.isMouseDown=!1,t.isVertical||(n=t.movingX),0==t.currentPageIndex&&t.view[t.paramXY]>0||t.currentPageIndex==t.listLen-1&&t.view[t.paramXY]<-t.currentPageIndex*t.distance){var l={};l[t.paramXY]=-t.currentPageIndex*t.distance,t._ease&&(l.ease=t._ease),annie.Tween.to(t.view,t.slideSpeed*t.reBound,l)}else{var d=t.currentPageIndex;if(t.isPageFollowToMove)if(Math.abs(t._moveDis)>5||Math.abs(n*t.follow<<1)>=t.distance)t.slideTo(n<0?d+1:d-1);else{var p=-t.currentPageIndex*t.distance;if(p==t.view[t.paramXY])return;t.view.mouseEnable=!1,t.isMoving=!0;var l={};l[t.paramXY]=p,t._ease&&(l.ease=t._ease),l.onComplete=function(){t.view.mouseEnable=!0,t.isMoving=!1,t.currentPageIndex>0&&t.pageList[t.currentPageIndex-1]&&t.pageList[t.currentPageIndex-1].parent==t.view&&t.view.removeChild(t.pageList[t.currentPageIndex-1]),t.currentPageIndex<t.listLen-1&&t.pageList[t.currentPageIndex+1]&&t.pageList[t.currentPageIndex+1].parent==t.view&&t.view.removeChild(t.pageList[t.currentPageIndex+1])},annie.Tween.to(t.view,.5*t.slideSpeed,l)}else Math.abs(n)>100&&!t._isBreak&&t.slideTo(n<0?d+1:d-1)}}},t.prototype.slideTo=function(e,t){void 0===t&&(t=!1);var a=this;if(a.currentPageIndex!=e&&!a.isMoving){var i=a.currentPageIndex,n=a.currentPageIndex<e;if(n){if(!(e<a.listLen&&a.canSlideNext))return;a.currentPageIndex=e}else{if(!(e>=0&&a.canSlidePrev))return;a.currentPageIndex=e}if(a.pageList[a.currentPageIndex]||(a.pageList[a.currentPageIndex]=new a.pageClassList[a.currentPageIndex]),a.pageList[a.currentPageIndex][a.paramXY]=a.currentPageIndex*a.distance,a.pageList[i][a.paramXY]=n?(a.currentPageIndex-1)*a.distance:(a.currentPageIndex+1)*a.distance,a.isPageFollowToMove||(a.view[a.paramXY]=-a.pageList[i][a.paramXY]),a.pageList[a.currentPageIndex]!=a.view&&a.view.addChild(a.pageList[a.currentPageIndex]),t)a.dispatchEvent("onSlideStart",{currentPage:a.currentPageIndex,lastPage:i}),a.view[a.paramXY]=-a.currentPageIndex*a.distance,a.view.removeChild(a.pageList[i]),a.dispatchEvent("onSlideEnd");else{a.view.mouseEnable=!1,a.isMoving=!0;var o={};o[a.paramXY]=-a.currentPageIndex*a.distance,a._ease&&(o.ease=a._ease),o.onComplete=function(){a.view.mouseEnable=!0,a.isMoving=!1,a.view.removeChild(a.pageList[i]),a.dispatchEvent("onSlideEnd")},annie.Tween.to(a.view,a.slideSpeed,o),a.dispatchEvent("onSlideStart",{currentPage:a.currentPageIndex,lastPage:i})}}},t.prototype.addPageList=function(e){var t=this;if(t.pageClassList=t.pageClassList.concat(e),0==t.listLen&&t.pageClassList.length>0){var a=new t.pageClassList[0];t.pageList.push(a),t.view.addChild(a)}t.listLen=t.pageClassList.length},t.prototype.destroy=function(){var t=this;t.pageList=null,t.pageClassList=null,e.prototype.destroy.call(this)},t}(t);e.SlidePage=a}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,a=annie.Shape,i=annie.Event,n=annie.MouseEvent,o=annie.Point,r=function(e){function r(r,s,l,d){var p=e.call(this)||this;p.totalPage=0,p.currPage=0,p.speed=.4,p.state="stop",p.timerArg0=0,p.timerArg1=0,p.px=0,p.py=0,p.rPage0=new t,p.rPage1=new t,p.pageMC=new t,p.leftPage=null,p.rightPage=null,p.rMask0=new a,p.rMask1=new a,p.shadow0=new a,p.shadow1=new a,p.sMask0=new a,p.sMask1=new a,p.pages=[],p.stageMP=new o,p.canFlip=!0;var c=p;c._instanceType="annieUI.FlipBook",c.getPageCallback=d,c.bW=r,c.bH=s,c.totalPage=l,c.currPage=c.toPage=0,c.crossGap=Math.sqrt(c.bW*c.bW+c.bH*c.bH),c.p1=new o(0,0),c.p2=new o(0,c.bH),c.p3=new o(c.bW+c.bW,0),c.p4=new o(c.bW+c.bW,c.bH),c.limitP1=new o(c.bW,0),c.limitP2=new o(c.bW,c.bH),c.toPosArr=[c.p3,c.p4,c.p1,c.p2],c.myPosArr=[c.p1,c.p2,c.p3,c.p4],c.rPage0.mouseEnable=!1,c.rPage1.mouseEnable=!1,c.shadow0.mouseEnable=!1,c.shadow1.mouseEnable=!1,c.setShadowMask(c.shadow0,1.5*c.bW,3*c.bH),c.setShadowMask(c.shadow1,1.5*c.bW,3*c.bH),c.rPage1.mask=c.rMask1,c.shadow1.mask=c.rMask1,c.shadow0.mask=c.rMask0,c.rPage0.mask=c.rMask0,c.shadow0.visible=!1,c.shadow1.visible=!1,c.addChild(c.pageMC),c.addChild(c.rPage0),c.addChild(c.shadow0),c.addChild(c.rPage1),c.addChild(c.shadow1),c.addChild(c.rMask0),c.addChild(c.rMask1),c.setPage(c.currPage),c.md=c.onMouseDown.bind(c),c.mu=c.onMouseUp.bind(c),c.mm=c.onMouseMove.bind(c);var u=c.onEnterFrame.bind(c);return c.addEventListener(annie.Event.ADD_TO_STAGE,function(e){c.stage.addEventListener(n.MOUSE_DOWN,c.md),c.stage.addEventListener(n.MOUSE_UP,c.mu),c.stage.addEventListener(n.MOUSE_MOVE,c.mm),c.addEventListener(i.ENTER_FRAME,u)}),c.addEventListener(annie.Event.REMOVE_TO_STAGE,function(e){c.stage.removeEventListener(n.MOUSE_DOWN,c.md),c.stage.removeEventListener(n.MOUSE_UP,c.mu),c.stage.removeEventListener(n.MOUSE_MOVE,c.mm),c.removeEventListener(i.ENTER_FRAME,u)}),p}return __extends(r,e),r.prototype.drawPage=function(e,t){var a,i,n=this;1==e?(t=n.checkLimit(t,n.limitP1,n.bW),t=n.checkLimit(t,n.limitP2,n.crossGap),i=n.getBookArr(t,n.p1,n.p2),a=i[1],n.getLayerArr(t,a,n.p1,n.p2,n.limitP1,n.limitP2),n.getShadow(n.shadow0,n.p1,t,.5),n.getShadow(n.shadow1,n.p1,t,.45),n.rPage1.rotation=n.angle(t,a)+90,n.rPage1.x=i[3].x,n.rPage1.y=i[3].y,n.rPage0.x=n.p1.x,n.rPage0.y=n.p1.y):2==e?(t=n.checkLimit(t,n.limitP2,n.bW),t=n.checkLimit(t,n.limitP1,n.crossGap),i=n.getBookArr(t,n.p2,n.p1),a=i[1],n.getLayerArr(t,a,n.p2,n.p1,n.limitP2,n.limitP1),n.getShadow(n.shadow0,n.p2,t,.5),n.getShadow(n.shadow1,n.p2,t,.45),n.rPage1.rotation=n.angle(t,a)-90,n.rPage1.x=i[2].x,n.rPage1.y=i[2].y,n.rPage0.x=n.p1.x,n.rPage0.y=n.p1.y):3==e?(t=n.checkLimit(t,n.limitP1,n.bW),t=n.checkLimit(t,n.limitP2,n.crossGap),i=n.getBookArr(t,n.p3,n.p4),a=i[1],n.getLayerArr(t,a,n.p3,n.p4,n.limitP1,n.limitP2),n.getShadow(n.shadow0,n.p3,t,.5),n.getShadow(n.shadow1,n.p3,t,.4),n.rPage1.rotation=n.angle(t,a)+90,n.rPage1.x=t.x,n.rPage1.y=t.y,n.rPage0.x=n.limitP1.x,n.rPage0.y=n.limitP1.y):(t=n.checkLimit(t,n.limitP2,n.bW),t=n.checkLimit(t,n.limitP1,n.crossGap),i=n.getBookArr(t,n.p4,n.p3),a=i[1],n.getLayerArr(t,a,n.p4,n.p3,n.limitP2,n.limitP1),n.getShadow(n.shadow0,n.p4,t,.5),n.getShadow(n.shadow1,n.p4,t,.4),n.rPage1.rotation=n.angle(t,a)-90,n.rPage1.x=a.x,n.rPage1.y=a.y,n.rPage0.x=n.limitP1.x,n.rPage0.y=n.limitP1.y),n.getShape(n.rMask1,n.layer1Arr),n.getShape(n.rMask0,n.layer0Arr)},r.prototype.checkLimit=function(e,t,a){var i=this,n=Math.abs(i.pos(t,e)),r=i.angle(t,e);if(n>a){var s=a*Math.sin(r/180*Math.PI),l=a*Math.cos(r/180*Math.PI);e=new o(t.x-l,t.y-s)}return e},r.prototype.getPage=function(e){var t=this;return t.pages[e-1]||(t.pages[e-1]=t.getPageCallback(e)),t.pages[e-1]},r.prototype.getBookArr=function(e,t,a){var i=this,n=[],r=Math.abs(.5*i.pos(t,e)),s=i.angle(t,e),l=r/Math.cos(s/180*Math.PI),d=new o(t.x-l,t.y),p=i.angle(e,d)-i.angle(e,a),c=i.pos(e,a),u=c*Math.sin(p/180*Math.PI),g=c*Math.cos(p/180*Math.PI),v=new o(t.x+g,t.y+u),h=i.angle(d,e),m=i.bW*Math.sin(h/180*Math.PI),w=i.bW*Math.cos(h/180*Math.PI),_=new o(v.x+w,v.y+m),P=new o(e.x+w,e.y+m);return n.push(e),n.push(v),n.push(_),n.push(P),n},r.prototype.getLayerArr=function(e,t,a,i,n,r){var s=this,l=[],d=[],p=Math.abs(.5*s.pos(a,e)),c=s.angle(a,e),u=p/Math.sin(c/180*Math.PI),g=p/Math.cos(c/180*Math.PI),v=new o(a.x-g,a.y),h=new o(a.x,a.y-u),m=t;if(Math.abs(s.pos(e,i))>s.bH){l.push(m);var w=Math.abs(.5*s.pos(m,i)),_=w/Math.cos(c/180*Math.PI);h=new o(i.x-_,i.y)}else d.push(i);l.push(h),l.push(v),l.push(e),s.layer1Arr=l,d.push(r),d.push(n),d.push(v),d.push(h),s.layer0Arr=d},r.prototype.getShape=function(e,t){var a=t.length;e.clear(),e.beginFill("#000"),e.moveTo(t[0].x,t[0].y);for(var i=1;i<a;i++)e.lineTo(t[i].x,t[i].y);e.endFill()},r.prototype.setShadowMask=function(e,t,a){e.beginLinearGradientFill([.5*-t,4,.5*t,4],[[0,"#000000",0],[1,"#000000",.6]]),e.drawRect(.5*-t,.5*-a,.5*t,a),e.endFill(),e.beginLinearGradientFill([.5*-t,4,.5*t,4],[[1,"#000000",0],[0,"#000000",.6]]),e.drawRect(0,.5*-a,.5*t,a),e.endFill()},r.prototype.getShadow=function(e,t,a,i){var n,o,r=this;e.visible=!0,e.x=a.x+(t.x-a.x)*i,e.y=a.y+(t.y-a.y)*i,e.rotation=r.angle(t,a),n=.5*Math.abs(t.x-a.x)/r.bW,o=1-n*n,e.scaleX=n+.1,e.alpha=o+.1},r.prototype.setPage=function(e){var t=this;e>0&&e<=t.totalPage&&(t.leftPage=t.getPage(e),t.leftPage.x=t.leftPage.y=0,t.pageMC.addChild(t.leftPage)),e+1>0&&e+1<t.totalPage&&(t.rightPage=t.getPage(e+1),t.rightPage.x=t.bW,t.rightPage.y=0,t.pageMC.addChild(t.rightPage))},r.prototype.onMouseDown=function(e){var t=this;if(t.canFlip&&"stop"==t.state){t.stageMP.x=e.clientX,t.stageMP.y=e.clientY;var a=t.globalToLocal(t.stageMP);t.stageMP=a,t.timerArg0=t.checkArea(a),t.timerArg0=t.timerArg0<0?-t.timerArg0:t.timerArg0,t.timerArg0>0&&(t.timerArg0<3&&t.currPage>0||t.timerArg0>2&&t.currPage<=t.totalPage-2)&&(t.state="start",t.flushPage(),t.dispatchEvent("onFlipStart"))}},r.prototype.onMouseUp=function(e){var t=this;if("start"==t.state){t.stageMP.x=e.clientX,t.stageMP.y=e.clientY;var a=t.globalToLocal(t.stageMP);t.timerArg1=t.checkArea(a),t.state="auto",t.stageMP=a}},r.prototype.onMouseMove=function(e){var t=this;if("start"==t.state){t.stageMP.x=e.clientX,t.stageMP.y=e.clientY;var a=t.globalToLocal(t.stageMP);t.stageMP=a}},r.prototype.checkArea=function(e){var t,a=this,i=a.bW+a.bW,n=a.bH;return e.x>0&&e.x<=.5*i?(t=e.y>0&&e.y<=.5*n?1:e.y>.5*n&&e.y<n?2:0,e.x<=50&&(t=e.y>0&&e.y<=50?-1:e.y>n-50&&e.y<n?-2:t),t):e.x>.5*i&&e.x<i?(t=e.y>0&&e.y<=.5*n?3:e.y>.5*n&&e.y<n?4:0,e.x>=i-50&&(t=e.y>0&&e.y<=50?-3:e.y>n-50&&e.y<n?-4:t),t):0},r.prototype.flipTo=function(e){var t,a=this;e=e%2==1?e-1:e,t=e-a.currPage,"stop"==a.state&&e>=0&&e<=a.totalPage&&0!=t&&(a.timerArg0=t<0?1:3,a.timerArg1=-1,a.toPage=e>a.totalPage?a.totalPage:e,a.state="auto",a.flushPage())},r.prototype.nextPage=function(){this.flipTo(this.currPage+2)},r.prototype.prevPage=function(){this.flipTo(this.currPage-1)},r.prototype.startPage=function(){this.flipTo(0)},r.prototype.endPage=function(){this.flipTo(this.totalPage)},r.prototype.flushPage=function(){var e,t,a=this,i=a.myPosArr[a.timerArg0-1],n=null;1==a.timerArg0||2==a.timerArg0?(a.toPage=a.toPage==a.currPage?a.currPage-2:a.toPage,e=a.currPage,t=a.toPage+1,this.pageMC.removeChild(a.leftPage),a.toPage>0&&(n=a.getPage(a.currPage-2),n.x=0,a.leftPage=n,a.pageMC.addChild(n))):3!=a.timerArg0&&4!=a.timerArg0||(a.toPage=a.toPage==a.currPage?a.currPage+2:a.toPage,e=a.currPage+1,t=a.toPage,a.pageMC.removeChild(a.rightPage),a.toPage+1<a.totalPage&&(n=a.getPage(a.currPage+3),n.x=a.bW,a.rightPage=n,a.pageMC.addChild(n))),a.px=i.x,a.py=i.y,e>0&&e<=a.totalPage&&(n=a.getPage(e),n.x=0,n.y=0,a.rPage0.addChild(n)),t>0&&t<=a.totalPage&&(n=a.getPage(t),n.x=0,n.y=0,a.rPage1.addChild(n))},r.prototype.onEnterFrame=function(e){var t,a,i,n,r,s,l=this,d=l.toPosArr[l.timerArg0-1],p=l.myPosArr[l.timerArg0-1];if("start"==l.state){s=l.speed;var c=l.stageMP;l.px+=(c.x-l.px)*s>>0,l.py+=(c.y-l.py)*s>>0;var u=new o(l.px,l.py);l.drawPage(l.timerArg0,u)}else"auto"==l.state&&(Math.abs(d.x-l.px)>1.5*l.bW&&l.timerArg1>0?(t=p.x,a=p.y,i=0):(t=d.x,a=d.y,i=1),n=t-l.px>>0,r=a-l.py>>0,l.timerArg1<0?(s=.7*l.speed,l.py=l.arc(l.bW,n,d.y)):(s=l.speed,l.py=r*s+l.py),l.px=n*s+l.px,l.drawPage(l.timerArg0,new o(l.px,l.py)),0==n&&0==r&&(l.rPage0.removeAllChildren(),l.rPage1.removeAllChildren(),l.shadow0.visible=!1,l.shadow1.visible=!1,l.toPage=0==i?l.currPage:l.toPage,l.currPage=l.toPage,l.pageMC.removeAllChildren(),l.setPage(l.currPage),l.state="stop",l.dispatchEvent("onFlipStop")))},r.prototype.arc=function(e,t,a){var i=2*e,n=e*e+i*i,o=Math.abs(t)-e;return a-(Math.sqrt(n-o*o)-i)},r.prototype.angle=function(e,t){var a=e.x-t.x,i=e.y-t.y,n=180*Math.atan2(i,a)/Math.PI;return n<0?n+360:n},r.prototype.pos=function(e,t){var a=e.x-t.x,i=e.y-t.y,n=Math.sqrt(a*a+i*i);return e.x>t.x?n:-n},r.prototype.destroy=function(){var t=this;t.md=null,t.mu=null,t.mm=null,t.layer0Arr=null,t.layer1Arr=null,t.toPosArr=null,t.myPosArr=null,t.rPage0=null,t.rMask0=null,t.rMask1=null,t.sMask0=null,t.sMask1=null,t.leftPage=null,t.rightPage=null,t.pageMC=null,t.rightPage=null,t.shadow0=null,t.shadow1=null,t.p1=null,t.p2=null,t.p3=null,t.p4=null,t.limitP1=null,t.limitP2=null,t.pages=null,t.stageMP=null,t.getPageCallback=null,e.prototype.destroy.call(this)},r}(t);e.FlipBook=r}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(t,a,i,n,o,r,s){void 0===r&&(r=!0),void 0===s&&(s=1);var l=e.call(this,n,o,0,r)||this;l._items=null,l._isInit=0,l.data=[],l.downL=null,l._lastFirstId=-1;var d=l;return d._instanceType="annieUI.ScrollList",d._itemW=a,d._itemH=i,d._items=[],d._itemClass=t,d._itemCount=0,d._cols=s,d._updateViewRect(),d.addEventListener(annie.Event.ENTER_FRAME,d.flushData.bind(d)),l}return __extends(t,e),Object.defineProperty(t.prototype,"loadingView",{get:function(){return this.downL},enumerable:!0,configurable:!0}),t.prototype.updateData=function(e,t){void 0===t&&(t=!1);var a=this;if(!a._isInit||t?a.data=e:a.data=a.data.concat(e),a._isInit=1,a._lastFirstId=-1,a.maxDistance=Math.ceil(a.data.length/a._cols)*a._itemRow,a.downL){a.downL[a.paramXY]=Math.max(a.distance,a.maxDistance);var i=a.downL.getWH();a.maxDistance+="x"==a.paramXY?i.width:i.height}},t.prototype.flushData=function(){var e=this;if(e._isInit>0){var t=(Math.abs(Math.floor(e.view[e.paramXY]/e._itemRow))-1)*e._cols;if((t=t<0?0:t)!=e._lastFirstId&&(e._lastFirstId=t,t!=e._items[0].id))for(var a=0;a<e._cols;a++)e.speed>0?e._items.unshift(e._items.pop()):e._items.push(e._items.shift());for(var i=0;i<e._itemCount;i++){var n=e._items[i];1==e._isInit&&(n._a2x_sl_id=-1),n._a2x_sl_id!=t&&(n.initData(e.data[t]?t:-1,e.data[t]),n[e.paramXY]=Math.floor(t/e._cols)*e._itemRow,n[e._disParam]=t%e._cols*e._itemCol,e.data[t]?(n._a2x_sl_id=t,n.visible=!0):(n._a2x_sl_id=-1,n.visible=!1)),t++}e._isInit=2}},t.prototype.setViewRect=function(t,a,i){e.prototype.setViewRect.call(this,t,a,i);var n=this;n._itemRow&&n._itemCol&&n._updateViewRect()},t.prototype._updateViewRect=function(){var e=this;e.isVertical?(e._disParam="x",e._itemRow=e._itemH,e._itemCol=e._itemW):(e._disParam="y",e._itemRow=e._itemW,e._itemCol=e._itemH);var t=(Math.ceil(e.distance/e._itemRow)+1)*e._cols;if(t!=e._itemCount){if(t>e._itemCount)for(var a=e._itemCount;a<t;a++){var i=new e._itemClass;i.id=-1,i.data=null,e._items.push(i),e.view.addChild(i)}else for(var a=0;a<e._itemCount-t;a++)e.view.removeChild(e._items.pop());e._itemCount=t,e._lastFirstId=-1}},t.prototype.setLoading=function(e){var t=this;if(t.downL){t.view.removeChild(t.downL);var a=t.downL.getWH();t.maxDistance-="x"==t.paramXY?a.width:a.height,t.downL=null}if(e){t.downL=e,t.view.addChild(e),t.downL[t.paramXY]=Math.max(t.distance,t.maxDistance);var a=t.downL.getWH();t.maxDistance+="x"==t.paramXY?a.width:a.height}else t.isStop=!1},t.prototype.destroy=function(){var t=this;t._items=null,t._itemClass=null,t.data=null,t.downL=null,e.prototype.destroy.call(this)},t}(e.ScrollPage);e.ScrollList=t}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(a,i,n){void 0===n&&(n="");var o=e.call(this,t._getDrawCanvas(a,i))||this;o.context=null,o._isMouseDown=!1,o._drawRadius=50,o.drawColor="#ffffff",o.bgColor="",o.totalStepList=[],o.currentStepId=0;var r=o;r._instanceType="annieUI.DrawingBoard",r.context=r.bitmapData.getContext("2d"),r.context.lineCap="round",r.context.lineJoin="round",r.reset(n);var s=r.onMouseDown.bind(r),l=r.onMouseMove.bind(r),d=r.onMouseUp.bind(r);return r.addEventListener(annie.MouseEvent.MOUSE_DOWN,s),r.addEventListener(annie.MouseEvent.MOUSE_MOVE,l),r.addEventListener(annie.MouseEvent.MOUSE_UP,d),o}return __extends(t,e),Object.defineProperty(t.prototype,"drawRadius",{get:function(){return this._drawRadius},set:function(e){this._drawRadius=e},enumerable:!0,configurable:!0}),t._getDrawCanvas=function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,a},t.prototype.onMouseDown=function(e){var t=this;t._isMouseDown=!0;var a=t.context;a.beginPath(),a.strokeStyle=t.drawColor,a.lineWidth=t._drawRadius;var i=e.localX>>0,n=e.localY>>0;a.moveTo(i,n),t.addStepObj={},t.addStepObj.c=t.drawColor,t.addStepObj.r=t._drawRadius,t.addStepObj.sx=i,t.addStepObj.sy=n,t.addStepObj.ps=[]},t.prototype.onMouseUp=function(e){var t=this;t._isMouseDown&&(t._isMouseDown=!1,t.addStepObj.ps&&t.addStepObj.ps.length>0&&(t.currentStepId++,t.totalStepList.push(t.addStepObj)))},t.prototype.onMouseMove=function(e){var t=this;if(t._isMouseDown){var a=t.context,i=e.localX>>0,n=e.localY>>0;a.lineTo(i,n),a.stroke(),t.addStepObj.ps.push(i,n)}},t.prototype.reset=function(e){void 0===e&&(e="");var t=this;""!=e&&(t.bgColor=e),""!=t.bgColor?(t.context.fillStyle=t.bgColor,t.context.fillRect(0,0,t.bitmapData.width,t.bitmapData.height)):t.context.clearRect(0,0,t.bitmapData.width,t.bitmapData.height),t.currentStepId=0,t.totalStepList=[]},t.prototype.cancel=function(e){void 0===e&&(e=0);var t=this;if(0==e)t.reset();else{if(!(t.currentStepId-e>=0))return!1;t.currentStepId-=e,t.totalStepList.splice(t.currentStepId,e),""!=t.bgColor?(t.context.fillStyle=t.bgColor,t.context.fillRect(0,0,t.bitmapData.width,t.bitmapData.height)):t.context.clearRect(0,0,t.bitmapData.width,t.bitmapData.height);for(var a=t.totalStepList.length,i=0;i<a;i++){var n=t.context;n.beginPath(),n.strokeStyle=t.totalStepList[i].c,n.lineWidth=t.totalStepList[i].r,n.moveTo(t.totalStepList[i].sx,t.totalStepList[i].sy);for(var o=t.totalStepList[i].ps,r=o.length,s=0;s<r;s+=2)n.lineTo(o[s],o[s+1]),n.stroke()}}return!0},t.prototype.destroy=function(){var t=this;t.context=null,t.totalStepList=null,t.drawColor=null,t.bgColor=null,t.addStepObj=null,e.prototype.destroy.call(this)},t}(annie.Bitmap);e.DrawingBoard=t}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(t,a,i,n,o){void 0===o&&(o=50);var r=e.call(this,t,a,i)||this;r._drawList=[],r._totalDraw=1,r._currentDraw=0;var s=r;return s._instanceType="annieUI.ScratchCard",s.drawColor=n,s.drawRadius=o,s.addEventListener(annie.MouseEvent.MOUSE_MOVE,function(e){if(s._isMouseDown){var t=Math.floor(e.localX/s._drawRadius),a=Math.floor(e.localY/s._drawRadius);if(s._drawList[t]&&s._drawList[t][a]){s._drawList[t][a]=!1,s._currentDraw++;var i=Math.floor(s._currentDraw/s._totalDraw*100);s.dispatchEvent("onDrawTime",{per:i})}}}),r}return __extends(t,e),t.prototype.reset=function(t){void 0===t&&(t=""),e.prototype.reset.call(this,t);var a=this;if(a._drawList){""!=t&&(a.drawColor=t),a._currentDraw=0;var i=Math.floor(a._bounds.width/a._drawRadius),n=Math.floor(a._bounds.height/a._drawRadius);a._totalDraw=i*n;for(var o=0;o<i;o++){a._drawList[o]=[];for(var r=0;r<n;r++)a._drawList[o][r]=!0}}},t.prototype.cancel=function(e){return void 0===e&&(e=0),console.log("no support"),!1},Object.defineProperty(t.prototype,"drawRadius",{set:function(e){var t=this;t._drawRadius=e;var a=Math.floor(t._bounds.width/t._drawRadius),i=Math.floor(t._bounds.height/t._drawRadius);t._totalDraw=a*i;for(var n=0;n<a;n++){t._drawList[n]=[];for(var o=0;o<i;o++)t._drawList[n][o]=!0}},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._drawList=null,e.prototype.destroy.call(this)},t}(e.DrawingBoard);e.ScratchCard=t}(annieUI||(annieUI={}));